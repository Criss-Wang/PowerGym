# Configuration for IEEE 34-bus DSO with three IEEE 13-bus microgrids
# This configuration creates a multi-agent environment with 3 cooperative microgrids

# Dataset path (relative to this setup directory)
dataset_path: data.pkl

# Training mode
train: true

# Environment parameters
penalty: 10.0          # Safety violation penalty coefficient
share_reward: true     # Share rewards across agents (encourages cooperation)
max_episode_steps: 96  # 4 days at 1-hour timesteps

# Convergence handling
convergence_failure_reward: -200.0
convergence_failure_safety: 20.0

# DSO (Distribution System Operator) configuration
# Non-actionable main grid based on IEEE 34-bus test feeder
dso_config:
  name: DSO
  load_area: BANC      # Load area from CAISO data
  renew_area: NP15     # Renewable energy area

# Microgrid configurations
# Each microgrid is based on IEEE 13-bus test feeder and connected to the DSO grid
microgrid_configs:
  - name: MG1
    load_area: AVA
    renew_area: NP15
    connection_bus: DSO Bus 850    # Connection point on DSO grid (after regulator)
    base_power: 1.0                # Base power in MW for normalization
    load_scale: 0.1                # Small load scaling for convergence
    devices:
      - name: solar_1
        type: Generator
        bus: Bus 671
        p_max_MW: 0.2
        p_min_MW: 0.0
        q_max_MVAr: 0.1
        q_min_MVAr: -0.1
        s_rated_MVA: 0.25
        renewable_type: solar
        cost_per_MWh: 0.0
      - name: ess_1
        type: ESS
        bus: Bus 680
        e_capacity_MWh: 0.5
        p_ch_max_MW: 0.1
        p_dsc_max_MW: 0.1
        eta_ch: 0.95
        eta_dsc: 0.95
        soc_init: 0.5
        soc_min: 0.1
        soc_max: 0.9

  - name: MG2
    load_area: PGE
    renew_area: SP15
    connection_bus: DSO Bus 858    # Connection point on DSO grid (after regulator 2)
    base_power: 1.0
    load_scale: 0.1
    devices:
      - name: solar_2
        type: Generator
        bus: Bus 671
        p_max_MW: 0.25
        p_min_MW: 0.0
        q_max_MVAr: 0.12
        q_min_MVAr: -0.12
        s_rated_MVA: 0.3
        renewable_type: solar
        cost_per_MWh: 0.0
      - name: ess_2
        type: ESS
        bus: Bus 680
        e_capacity_MWh: 0.6
        p_ch_max_MW: 0.12
        p_dsc_max_MW: 0.12
        eta_ch: 0.95
        eta_dsc: 0.95
        soc_init: 0.5
        soc_min: 0.1
        soc_max: 0.9

  - name: MG3
    load_area: SCE-TAC
    renew_area: ZP26
    connection_bus: DSO Bus 834    # Connection point on DSO grid
    base_power: 1.0
    load_scale: 0.1
    devices:
      - name: solar_3
        type: Generator
        bus: Bus 671
        p_max_MW: 0.15
        p_min_MW: 0.0
        q_max_MVAr: 0.08
        q_min_MVAr: -0.08
        s_rated_MVA: 0.2
        renewable_type: solar
        cost_per_MWh: 0.0
      - name: ess_3
        type: ESS
        bus: Bus 680
        e_capacity_MWh: 0.4
        p_ch_max_MW: 0.08
        p_dsc_max_MW: 0.08
        eta_ch: 0.95
        eta_dsc: 0.95
        soc_init: 0.5
        soc_min: 0.1
        soc_max: 0.9
